DROP TABLE EMP;

CREATE TABLE DEPTT(DEPTNO INT NOT NULL, DNAME CHAR(14),LOC CHAR(13),CONSTRAINT DEPT_PRIMARY_KEY PRIMARY KEY (DEPTNO));

INSERT INTO DEPTT VALUES (10,'ACCOUNTING','NEW YORK');
INSERT INTO DEPTT VALUES (20,'RESEARCH','DALLAS');
INSERT INTO DEPTT VALUES (30,'SALES','CHICAGO');
INSERT INTO DEPTT VALUES (40,'OPERATIONS','BOSTON');

CREATE TABLE EMPP(EMPNO INT NOT NULL,ENAME CHAR(10),JOB CHAR(9),MGR INT CONSTRAINT EMP_SELF_KEY REFERENCES EMPP (EMPNO),HIREDATE DATE,SAL INT,COMM INT,DEPTNO INT NOT NULL,CONSTRAINT EMP_FOREIGN_KEY FOREIGN KEY (DEPTNO) REFERENCES DEPTT (DEPTNO),CONSTRAINT EMP_PRIMARY_KEY PRIMARY KEY (EMPNO));
INSERT INTO EMPP VALUES (7839,'KING','PRESIDENT',NULL,'17-NOV-1981',5000,NULL,10);
INSERT INTO EMPP VALUES (7698,'BLAKE','MANAGER',7839,'1-MAY-1981',2850,NULL,30);
INSERT INTO EMPP VALUES (7782,'CLARK','MANAGER',7839,'9-JUN-1981',2450,NULL,10);
INSERT INTO EMPP VALUES (7566,'JONES','MANAGER',7839,'2-APR-1981',2975,NULL,20);
INSERT INTO EMPP VALUES (7654,'MARTIN','SALESMAN',7698,'28-SEP-1981',1250,1400,30);
INSERT INTO EMPP VALUES (7499,'ALLEN','SALESMAN',7698,'20-FEB-1981',1600,300,30);
INSERT INTO EMPP VALUES (7844,'TURNER','SALESMAN',7698,'8-SEP-1981',1500,0,30);
INSERT INTO EMPP VALUES (7900,'JAMES','CLERK',7698,'3-DEC-1981',950,NULL,30);
INSERT INTO EMPP VALUES (7521,'WARD','SALESMAN',7698,'22-FEB-1981',1250,500,30);
INSERT INTO EMPP VALUES (7902,'FORD','ANALYST',7566,'3-DEC-1981',3000,NULL,20);
INSERT INTO EMPP VALUES (7369,'SMITH','CLERK',7902,'17-DEC-1980',800,NULL,20);
INSERT INTO EMPP VALUES (7788,'SCOTT','ANALYST',7566,'09-DEC-1982',3000,NULL,20);
INSERT INTO EMPP VALUES (7876,'ADAMS','CLERK',7788,'12-JAN-1983',1100,NULL,20);
INSERT INTO EMPP VALUES (7934,'MILLER','CLERK',7782,'23-JAN-1982',1300,NULL,10);
/* 19F-0916 M.Abdullah SE(4A) DB LAB JOINS */


/* Q1. List our employees with their department names.*/

Select EMPP.*, DNAME
From EMPP, DEPTT 
where EMPP.DEPTNO = DEPTT.DEPTNO

/* Q2. Display employees with their department name*/

Select ENAME, DNAME
From EMPP, DEPTT 
where EMPP.DEPTNO = DEPTT.DEPTNO

/* Q3. How many employees who are working in different departments and display with department name.*/

Select COUNT(ENAME) as Employees, DNAME
From EMPP Right Join DEPTT 
On EMPP.DEPTNO = DEPTT.DEPTNO
Group by DNAME

/* Q4. How many employees who are working in sales department.*/ 

Select COUNT(ENAME) as Employees, DNAME
From EMPP, DEPTT 
where EMPP.DEPTNO = DEPTT.DEPTNO AND DEPTT.DNAME = 'SALES'
Group by DNAME

/* Q5. Which is the department having greater than or equal to 5 employees and display the department names in ascending order.*/

Select COUNT(ENAME) as Employees, DNAME
From EMPP, DEPTT 
where EMPP.DEPTNO = DEPTT.DEPTNO 
Group by DNAME
Having COUNT(ENAME) >= 5
Order By DNAME ASC 

/* Q6. List out the total salary of each department*/ 

Select SUM(SAL) as Total_Salary, DNAME
From EMPP Right Join DEPTT 
On EMPP.DEPTNO = DEPTT.DEPTNO
Group by DNAME

/* Q7. Display employee details with all departments.*/

Select EMPP.*, DNAME
From EMPP Right Join DEPTT 
On EMPP.DEPTNO = DEPTT.DEPTNO

/* Q8. Display the employee details with their manager names.*/

Select  P.ENAME as Manager_Name ,T.*
From EMPP P Right Join EMPP T
On P.EMPNO = T.MGR


/* Q9. Display the employee details who earn more than their managers' salaries.*/

Select P.ENAME as Manager_Name ,T.*
From EMPP P, EMPP T
where P.EMPNO = T.MGR AND T.SAL > P.SAL

/* Q10. Show the no. of employees working under every manager.*/

Select COUNT(P.EMPNO) as Total_Employees, T.MGR as Manager_ID
From EMPP P , EMPP T
where P.EMPNO = T.MGR
Group By T.MGR

